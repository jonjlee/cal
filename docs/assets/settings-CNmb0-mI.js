import{g as i,d as a,e as d}from"./model-8AZnbWHn.js";import{A as s}from"./auth-Cml8w5An.js";import"https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm";import"https://cdn.jsdelivr.net/gh/lit/dist@2.8.0/core/lit-core.min.js";import"https://cdn.jsdelivr.net/npm/dayjs@1.11.10/+esm";import"https://cdn.jsdelivr.net/npm/lit-html@2.8.0/directives/live.min.js";const l=window.AUTH=new s("settings.html",window.location.search);document.on("DOMContentLoaded",()=>{l.auth.then(e=>{c(e.user,e.deptId),m(e).then(t=>f(t)).catch(t=>{console.log(t)})}).catch(e=>{console.log(e)})});function c(e,t){var n;!e||!e.email?userNameLabel.innerText="Not logged in":(n=e.user_metadata)!=null&&n.restricted?userNameLabel.innerText="View Only":userNameLabel.innerText=e.email,t&&(deptNameLabel.href="./cal.html?d="+t)}async function m(e){var r;if(!e.user||e.deptId==null)throw new Error(`Unable to fetch due to invalid user and department ${(r=e.user)==null?void 0:r.id}, ${e.deptId}`);const t=i(e.deptId),n=a(e.deptId);return Promise.all([t,n]).then(async o=>{if(t.error||n.error)throw new Error(`Error fetching data: ${[t.error,n.error]}`);return{auth:e,dept:o[0].data,settings:o[1].data}})}function f({auth:e,dept:t,settings:n}){if(!e||!t||!n)throw new Error("Invalid login or user data");loadingDiv.classList.add("d-none"),settingsDiv.classList.remove("d-none"),calList.settings=n,logout.addEventListener("click",g)}async function g(e){e.preventDefault(),await d.signOut(),window.location.href="./login.html"}
